<ns-action-bar title="Start New Game" showAdd="true"></ns-action-bar>
<StackLayout>

    <ScrollView>
        <StackLayout class="new-game" backgroundColor="#f1f2f2">
            <GridLayout rows="auto,auto" columns="auto,*" padding="10 10 5 10">
                <Label row="0" col="0" text="Select Player Mode" textWrap="true"></Label>
                <Label row="0" col="1" class="fa expand-options" horizontalAlignment="right" text="{{ showSelectPlayer ? '&#xf067;' : '&#xf068;' }}"
                    textWrap="true" padding="4" borderWidth="2" borderColor="#A9A9A9" (tap)="showSelectPlayer = !showSelectPlayer"></Label>
            </GridLayout>

            <CardView margin="10" elevation="40" radius="1" width="95%" margin="15 0 15 0" visibility="{{ !showSelectPlayer ? 'visible' : 'collapsed' }}">
                <StackLayout orientation="horizontal" horizontalAlignment="center" backgroundColor="white">
                    <StackLayout orientation="horizontal" [class.selected-player]="gameOptions.playerMode === 0"
                    (tap)="gameOptions.playerMode = 0;" width="50%">
                        <Image src="~/assets/images/single_player.png" height="30" width="30"
                            marginLeft="10" verticalAlignment="center" marginRight="10" borderRadius="50"></Image>

                        <Label text="Single Player" textWrap="true"  height="50" padding="15 15 5 15"></Label>
                    </StackLayout>

                    <StackLayout orientation="horizontal" [class.selected-player]="gameOptions.playerMode === 1"
                    (tap)="gameOptions.playerMode = 1;gameOptions.opponentType=0" width="50%">
                    
                    <Label text="Two Players" textWrap="true" height="50" padding="15 15 5 15"></Label>
                    </StackLayout>
                </StackLayout>
            </CardView>

            <CardView margin="10" elevation="40" radius="1" width="95%" margin="20" visibility="{{ showSelectPlayer ? 'visible' : 'collapsed' }}"
                backgroundColor="white">
                <StackLayout orientation="horizontal" horizontalAlignment="center">
                    <Label [text]="gameOptions.playerMode === 0 ? 'Single Player' : 'Two Player'" textWrap="true" width="50%"
                        height="50" padding="17 15 5 17"></Label>
                    <Label text="{{getGameMode()}}" textWrap="true" width="50%" height="50" padding="17 15 5 17"></Label>
                </StackLayout>
            </CardView>

            <CardView visibility="{{ !showSelectPlayer ? 'visible' : 'collapsed' }}" *ngIf="gameOptions.playerMode === 1"
                margin="15 0 15 0" backgroundColor="white">
                <StackLayout>
                    <GridLayout rows="auto,auto" columns="auto,*" (tap)="gameOptions.opponentType=0;">
                        <Label row="0" col="0" text="Random" textWrap="true" padding="15"></Label>
                        <CheckBox row="0" col="1" checked="true" horizontalAlignment="right" android:fillColor="#89C24F"
                            boxType="circle" *ngIf="gameOptions.opponentType == 0"></CheckBox>
                    </GridLayout>

                    <GridLayout rows="*,*" columns="*">
                        <Label row="0" col="0" text="With Friends" textWrap="true" padding="15" (tap)="gameOptions.opponentType=1;"></Label>
                        <CheckBox row="0" col="1" checked="true" horizontalAlignment="right" android:fillColor="#89C24F"
                            boxType="circle" *ngIf="gameOptions.opponentType == 1" (tap)="gameOptions.opponentType=1;"></CheckBox>
                        <StackLayout row="1" col="0" *ngIf="gameOptions.opponentType == 1">
                            <RadListView [items]="dataItem">
                                <ng-template let-item="item">
                                    <StackLayout paddingTop="10" class="friend-list" (tap)="selectFriendId(item)">
                                        <Image [src]="getImageUrl(userDict[item])" backgroundColor="gray" stretch="aspectFill"
                                            height="64" width="64" marginLeft="10" verticalAlignment="center"
                                            marginRight="10" borderRadius="50"></Image>
                                        <Label class="nameLabel" [text]="userDict[item]?.displayName"
                                            horizontalAlignment="center"></Label>
                                        <CheckBox visibility="{{ item === friendUserId ? 'visible' : 'collapsed' }}"
                                            checked="true" horizontalAlignment="center" android:fillColor="#89C24F"
                                            boxType="circle"></CheckBox>
                                    </StackLayout>
                                </ng-template>
                                <ListViewLinearLayout tkListViewLayout scrollDirection="Horizontal"></ListViewLinearLayout>
                            </RadListView>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>
            </CardView>

            <GridLayout rows="auto,auto" columns="auto,*" padding="5" margin="0 5">
                <Label row="0" col="0" text="Select Preferred Category" textWrap="true"></Label>
                <Label row="0" col="1" class="fa expand-options" horizontalAlignment="right" text="{{ showSelectCategory ? '&#xf067;' : '&#xf068;' }}"
                    textWrap="true" padding="4" borderWidth="2" borderColor="#A9A9A9" (tap)="showSelectCategory = !showSelectCategory"></Label>
            </GridLayout>

            <CardView margin="5 10" visibility="{{ !showSelectCategory ? 'visible' : 'collapsed' }}" backgroundColor="white">
                <StackLayout>
                    <GridLayout rows="auto,auto" columns="auto,*" padding="10" class="two-player-option" *ngFor="let category of categories"
                        (tap)="selectCategory(category)">
                        <Label [text]="category.categoryName" row="0" col="0" textWrap="true" padding="8"></Label>
                        <CheckBox row="0" col="1" checked="true" horizontalAlignment="right" android:fillColor="#89C24F"
                            boxType="circle" *ngIf="category.requiredForGamePlay || category.isSelected"></CheckBox>
                    </GridLayout>

                </StackLayout>
            </CardView>

            <CardView margin="5 10" visibility="{{ showSelectCategory ? 'visible' : 'collapsed' }}" backgroundColor="white">
                <Label padding="15" text="{{getSelectedCatName()}}" textWrap="true"></Label>
            </CardView>


            <GridLayout rows="auto,auto" columns="auto,*" padding="5" margin="0 5">
                <Label row="0" col="0" text="Tags associated categories" textWrap="true"></Label>
                <Label row="0" col="1" class="fa expand-options" horizontalAlignment="right" text="{{ showSelectTag ? '&#xf067;' : '&#xf068;' }}"
                    textWrap="true" padding="4" borderWidth="2" borderColor="#A9A9A9" (tap)="showSelectTag = !showSelectTag"></Label>
            </GridLayout>

            <CardView margin="5 10" visibility="{{ !showSelectTag ? 'visible' : 'collapsed' }}" backgroundColor="white">
                <StackLayout>
                    <GridLayout rows="auto,auto" columns="auto,*" padding="10" class="two-player-option" *ngFor="let tag of selectedTags">
                        <Label [text]="tag" row="0" col="0" textWrap="true" padding="8"></Label>
                        <Label row="0" col="1" class="fa" text="&#xf00d;" fontSize="18" textWrap="true" padding="8"
                            horizontalAlignment="right" (tap)="removeEnteredTag(tag)"></Label>
                    </GridLayout>
                    <GridLayout rows="auto,auto" columns="*,auto" padding="10" class="two-player-option">
                        <Label row="0" col="0" text="Add Tags" textWrap="true"></Label>
                        <StackLayout row="1" col="0" tkExampleTitle tkToggleNavButton ios:backgroundColor="#CDCECE"
                            padding="5">
                            <RadAutoCompleteTextView #autocomplete hint="Select Tag" [items]="dataItems" completionMode="Contains"
                                showCloseButton="true" (didAutoComplete)="onDidAutoComplete($event)" (textChanged)="onTextChanged($event)"
                                border="none">
                                <SuggestionView tkAutoCompleteSuggestionView>
                                    <ng-template tkSuggestionItemTemplate let-item="item">
                                        <StackLayout orientation="vertical" padding="10">
                                            <Label [text]="item.text"></Label>
                                        </StackLayout>
                                    </ng-template>
                                </SuggestionView>
                            </RadAutoCompleteTextView>
                        </StackLayout>
                        <Button row="1" col="1" text="Add" (tap)="addCustomTag()" padding="10" backgroundColor="#89C24F"
                            color="#ffffff"></Button>
                    </GridLayout>
                </StackLayout>
            </CardView>
            <CardView margin="5 10" visibility="{{ showSelectTag ? 'visible' : 'collapsed' }}" backgroundColor="white">
                <Label padding="15" [text]="selectedTags.join(', ')" textWrap="true"></Label>
            </CardView>

            <StackLayout margin="5 10">
                <Button text="START A NEW GAME" (tap)="startGame()" backgroundColor="#D4493D" color="#ffffff" padding="20 0"></Button>
            </StackLayout>
        </StackLayout>
    </ScrollView>
</StackLayout>